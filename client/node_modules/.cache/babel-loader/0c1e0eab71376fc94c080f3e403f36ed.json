{"ast":null,"code":"import _classCallCheck from \"/home/efimenko/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/alive-empire-game/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/efimenko/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/alive-empire-game/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/efimenko/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/alive-empire-game/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/efimenko/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/alive-empire-game/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/efimenko/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/alive-empire-game/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/efimenko/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/alive-empire-game/client/src/Game.js\";\nimport React, { createRef, Component, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { Button, Container } from 'reactstrap';\nimport io from 'socket.io-client';\nimport { Route, withRouter } from 'react-router-dom';\nimport { Howl, Howler } from 'howler';\nimport './Game.css';\nimport { Chat, Statistics, GameBar } from './modules';\nimport { BlurContainer } from './components';\nimport { InitModal } from './containers';\nimport { initSocket as _initSocket, sendLoginInfo as _sendLoginInfo, login, sendMousePosition as _sendMousePosition } from './actions';\nimport Engine from './engine';\nvar sounds = ['music/Polyphia – O.D..mp3', 'music/Polyphia G.O.A.T. (Official Music Video).mp3', 'music/Polyphia - Crush.mp3'];\n\nvar Music = function Music(sounds) {\n  var id = 0;\n  var count = sounds.length;\n  var howlers = sounds.map(function (x) {\n    return new Howl({\n      src: x,\n      volume: 0.9,\n      onend: function onend() {\n        id = (id + 1) % count;\n        howlers[id].play();\n      }\n    });\n  });\n\n  var play = function play() {\n    return howlers[0].play();\n  };\n\n  return {\n    play: play\n  };\n};\n\nMusic(sounds).play();\nvar RouterAnimation = withRouteAnimation(function (_ref) {\n  var isLogin = _ref.isLogin,\n      login = _ref.login,\n      configs = _ref.configs;\n  return React.createElement(Route, {\n    exact: true,\n    path: \"/\",\n    render: function render() {\n      return React.createElement(InitModal, {\n        isLogin: isLogin,\n        login: login,\n        configs: configs,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56\n        },\n        __self: this\n      });\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  });\n});\nvar iconUrls = ['./icon1.png', './icon2.png', './icon3.png'];\nvar iconObj = {\n  blue: './icon1.png',\n  red: './icon2.png',\n  green: './icon3.png'\n};\nvar shadow = {\n  'blue': {\n    r: 100,\n    g: 100,\n    b: 255\n  },\n  'red': {\n    r: 255,\n    g: 100,\n    b: 100\n  },\n  'green': {\n    r: 5,\n    g: 100,\n    b: 5\n  }\n};\nvar urls = ['./hero1.png', './hero.png', './hero2.png', './waterbear.png'];\nvar images = urls.map(function (url) {\n  return new Image();\n});\nimages.forEach(function (img, id) {\n  return img.src = urls[id];\n});\nvar rules = [{\n  name: 'blue',\n  image: images[0],\n  shadow: shadow['blue']\n}, {\n  name: 'red',\n  image: images[1],\n  shadow: shadow['red']\n}, {\n  name: 'green',\n  image: images[2],\n  shadow: shadow['green']\n}];\nvar configs = {\n  urls: iconUrls,\n  descriptions: {\n    blue: 'супер быстрые',\n    red: 'супер сильные',\n    green: \"супер плодовитые\"\n  }\n};\n\nvar Game =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Game, _Component);\n\n  function Game(props) {\n    var _this;\n\n    _classCallCheck(this, Game);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Game).call(this, props));\n    _this.state = {\n      statistics: []\n    };\n\n    _this.init = function () {\n      _this.resize();\n\n      _this.engine = Engine(_this._canvas.current);\n      rules.forEach(_this.engine.addConfig);\n\n      _this.change();\n\n      _this.engine.onMouse(function (x, y) {\n        return _this.props.sendMousePosition(_this.socket, x, y);\n      });\n    };\n\n    _this.resize = function () {\n      var parent = _this._canvas.current.parentElement;\n      _this._canvas.current.width = parent.clientWidth;\n      _this._canvas.current.height = parent.clientHeight;\n    };\n\n    _this.login = function () {\n      _this.change();\n\n      _this.props.Login();\n\n      _this.props.sendLoginInfo(_this.socket, _this.props.config);\n    };\n\n    _this.change = function () {\n      _this.engine.use(_this.props.race);\n    };\n\n    _this._canvas = createRef();\n    _this.engine = null;\n    return _this;\n  }\n\n  _createClass(Game, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.init();\n      this.socket = io();\n      this.props.initSocket(this.socket, this.engine);\n      window.addEventListener('resize', this.init);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var statistics = this.state.statistics;\n      var color = shadow[this.props.race];\n      return React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, React.createElement(RouterAnimation, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }), React.createElement(BlurContainer, {\n        kernel: 14,\n        is: !this.props.isLogin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"h-100 w-100 background tools\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, React.createElement(\"canvas\", {\n        ref: this._canvas,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }), React.createElement(Statistics, {\n        color: \"rgb(\".concat(color.r, \",\").concat(color.g, \",\").concat(color.b),\n        value: 100,\n        list: this.props.stats,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }), React.createElement(Container, {\n        className: \"d-flex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(GameBar, {\n        url: iconObj[this.props.race],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return Game;\n}(Component);\n/*\n*/\n//Вернуть и очень много работы с engine\n//  <Statistics color={`rgb(${color.r},${color.g},${color.b}`}  value={statistics[this.props.race]} list={statistics} urls = {iconUrls}/>\n// <Button  color='danger' onClick={this.toggle()}> on </Button>\n\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    isLogin: state.isLogin,\n    race: state.race,\n    config: {\n      race: state.race,\n      name: state.name\n    },\n    stats: [{\n      race: 'blue',\n      url: iconUrls[0],\n      score: state.statistics[0]\n    }, {\n      race: 'red',\n      url: iconUrls[1],\n      score: state.statistics[1]\n    }, {\n      race: 'green',\n      url: iconUrls[2],\n      score: state.statistics[2]\n    }]\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    initSocket: function initSocket(socket, engine) {\n      return dispatch(_initSocket(socket, engine));\n    },\n    Login: function Login() {\n      return dispatch(login());\n    },\n    sendMousePosition: function sendMousePosition(socket, x, y) {\n      return dispatch(_sendMousePosition(socket, x, y));\n    },\n    sendLoginInfo: function sendLoginInfo(socket, config) {\n      return dispatch(_sendLoginInfo(socket, config));\n    }\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Game));","map":{"version":3,"sources":["/home/efimenko/Рабочий стол/alive-empire-game/client/src/Game.js"],"names":["React","createRef","Component","Fragment","connect","Button","Container","io","Route","withRouter","Howl","Howler","Chat","Statistics","GameBar","BlurContainer","InitModal","initSocket","sendLoginInfo","login","sendMousePosition","Engine","sounds","Music","id","count","length","howlers","map","x","src","volume","onend","play","RouterAnimation","withRouteAnimation","isLogin","configs","iconUrls","iconObj","blue","red","green","shadow","r","g","b","urls","images","url","Image","forEach","img","rules","name","image","descriptions","Game","props","state","statistics","init","resize","engine","_canvas","current","addConfig","change","onMouse","y","socket","parent","parentElement","width","clientWidth","height","clientHeight","Login","config","use","race","window","addEventListener","color","stats","mapStateToProps","score","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { createRef, Component, Fragment } from 'react';\nimport { connect } from 'react-redux'\nimport { Button, Container } from 'reactstrap'\nimport io from 'socket.io-client'\nimport { Route, withRouter } from 'react-router-dom'\nimport {Howl, Howler} from 'howler'\nimport './Game.css'\nimport {\n  Chat,\n  Statistics,\n  GameBar\n} from './modules'\nimport { \n  BlurContainer,\n} from './components'\n\nimport {\n  InitModal\n} from './containers'\n\nimport { \n  initSocket,\n  sendLoginInfo,\n  login,\n  sendMousePosition\n} from './actions'\n\nimport Engine from './engine'\n\nconst sounds = [\n  'music/Polyphia – O.D..mp3',\n  'music/Polyphia G.O.A.T. (Official Music Video).mp3',\n  'music/Polyphia - Crush.mp3'\n]\n\nconst Music = (sounds) => {\n  let id = 0;\n  const count = sounds.length\n  const howlers = sounds.map(x => new Howl({\n    src:x,\n    volume:0.9,\n    onend: function(){\n      id = (id + 1) % count\n      howlers[id].play()\n    }\n  }))\n  const play = () => howlers[0].play()\n  return {\n    play\n  }\n}\n\nMusic(sounds).play()\n\nconst RouterAnimation = withRouteAnimation(({isLogin, login,configs}) => <Route exact path='/' render={ () => {\n            return <InitModal isLogin = {isLogin} login = {login} configs = {configs} />\n        }}/>)\n\n\nconst iconUrls = ['./icon1.png','./icon2.png','./icon3.png']\nconst iconObj = {blue:'./icon1.png',red:'./icon2.png',green:'./icon3.png'}\nconst shadow = {'blue':{r:100,g:100,b:255},'red':{r:255,g:100,b:100},'green':{r:5,g:100,b:5}}\nconst urls = ['./hero1.png', './hero.png', './hero2.png', './waterbear.png']\nconst images = urls.map( url => new Image())\nimages.forEach((img, id) => img.src = urls[id])\n\nconst rules = [{name:'blue',image: images[0],shadow:shadow['blue']}, {name:'red', image:images[1],shadow:shadow['red']}, {name:'green', image:images[2],shadow:shadow['green']}]\n\nconst configs = {\n  urls: iconUrls,\n  descriptions: {blue:'супер быстрые',red:'супер сильные',green:\"супер плодовитые\"}\n}\n\n\nclass Game extends Component {\nstate = {\n  statistics: [],\n}\nconstructor(props){\n   super(props)\n   this._canvas = createRef()\n   this.engine = null\n}\ncomponentDidMount(){\n  this.init()\n  this.socket = io()\n  this.props.initSocket(this.socket, this.engine)\n  window.addEventListener('resize', this.init)\n}\ninit = () => {\n  this.resize()\n  this.engine = Engine(this._canvas.current)\n  rules.forEach(this.engine.addConfig)\n  this.change()\n  this.engine.onMouse((x,y) => this.props.sendMousePosition(this.socket, x, y))\n}\n\nresize = () => {\n  const parent = this._canvas.current.parentElement;\n  this._canvas.current.width = parent.clientWidth\n  this._canvas.current.height = parent.clientHeight\n}\n\nlogin = () => {\n  this.change()\n  this.props.Login()\n  this.props.sendLoginInfo(this.socket, this.props.config)\n}\n\nchange = () => {\n  this.engine.use(this.props.race)\n}\n\n  render(){\n    const { statistics } = this.state\n    const  color = shadow[this.props.race]\n    return (\n      <Fragment>\n        <RouterAnimation / >\n        <BlurContainer  kernel={14} is={!this.props.isLogin}>\n          <div  className='h-100 w-100 background tools'>\n            <canvas  ref={this._canvas}/>\n            <Statistics color={`rgb(${color.r},${color.g},${color.b}`}  value={100}  list={this.props.stats}/>\n            <Container className='d-flex'>\n              <GameBar  url={iconObj[this.props.race]} />\n            </Container>\n          </div>\n        </BlurContainer>\n      </Fragment>\n    )\n  }\n}\n\n\n/*\n*/\n//Вернуть и очень много работы с engine\n\n\n//  <Statistics color={`rgb(${color.r},${color.g},${color.b}`}  value={statistics[this.props.race]} list={statistics} urls = {iconUrls}/>\n// <Button  color='danger' onClick={this.toggle()}> on </Button>\n\nconst mapStateToProps = state => {\n  return {\n    isLogin: state.isLogin,\n    race: state.race,\n    config: {\n      race: state.race,\n      name: state.name\n    },\n    stats:[\n      {race:'blue', url: iconUrls[0], score: state.statistics[0]},\n      {race:'red', url: iconUrls[1], score: state.statistics[1]},\n      {race:'green', url: iconUrls[2], score: state.statistics[2]}\n    ]\n  }\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    initSocket: (socket, engine) => dispatch(initSocket(socket, engine)),\n    Login: () => dispatch(login()),\n    sendMousePosition: (socket, x, y) => dispatch(sendMousePosition(socket, x, y)),\n    sendLoginInfo: (socket, config) => dispatch(sendLoginInfo(socket, config)),\n  }\n}\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Game))\n\n"]},"metadata":{},"sourceType":"module"}